<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Ph√≤ngt·ªët - Danh s√°ch ph√≤ng</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        :root{
            --brand: #22c7c7;
            --brand-2: #0ea5a5;
            --brand-dark: #0b5564;
            --ink: #0f172a;
            --muted: #64748b;
            --card: #ffffff;
            --radius: 18px;
            --side-top-gap: 16px;
        }

        body{ color: var(--ink); }

        /* Header */
        .pt-header{
            position: sticky;
            top: 0;
            z-index: 1030;
            background: #fff;
            border-bottom: 1px solid rgba(15,23,42,.08);
            will-change: transform;
            transition: transform .22s ease;
        }
        .pt-header.is-hidden{ transform: translateY(-100%); }

        /* ch·ª´a kho·∫£ng tr·ªëng ƒë·ªÉ n·ªôi dung kh√¥ng b·ªã che */
        .header-spacer{ height: var(--header-h, 0px); }

        .pt-container{ max-width: 1200px; }

        .brand{
            display:flex;
            gap:10px;
            align-items:center;
            text-decoration:none;
            color: var(--ink);
        }
        .brand .logo{
            width: 38px; height: 38px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--brand), var(--brand-dark));
            display:flex;
            align-items:center;
            justify-content:center;
            box-shadow: 0 .5rem 1rem rgba(34,199,199,.25);
            flex: 0 0 auto;
            overflow:hidden;
        }
        .brand .name{
            font-weight: 900;
            letter-spacing: .2px;
            font-size: 1.05rem;
            line-height: 1.05;
        }
        .brand .sub{
            font-size: .82rem;
            color: var(--muted);
            margin-top: -2px;
        }

        .nav-pill{
            border-radius: 999px;
            padding: .45rem .85rem;
            border: 1px solid rgba(15,23,42,.12);
            background: #fff;
            color: var(--ink);
            transition: all .15s ease;
            text-decoration:none;
            font-size: .9rem;
            display:inline-flex;
            align-items:center;
            gap:8px;
        }
        .nav-pill:hover{
            transform: translateY(-1px);
            border-color: rgba(34,199,199,.55);
            box-shadow: 0 .75rem 1.5rem rgba(2,132,199,.08);
        }
        .nav-pill.primary{
            background: linear-gradient(135deg, var(--brand), var(--brand-2));
            border: none;
            color: #fff;
        }
        .nav-pill.primary:hover{
            filter: brightness(.98);
            box-shadow: 0 .9rem 2rem rgba(34,199,199,.25);
        }
        .nav-pill.dark{
            background: #0f172a;
            border: none;
            color:#fff;
        }
        .nav-pill.dark:hover{ background:#111c33; }

        /* Search bar */
        .search-wrap{
            background: linear-gradient(135deg, var(--brand), var(--brand-2));
            padding: 16px 0;
        }
        .search-bar{
            background:#fff;
            border-radius: 20px;
            padding: 10px;
            box-shadow: 0 1rem 2.5rem rgba(2,6,23,.12);
        }
        .s-field{
            border: 1px solid rgba(15,23,42,.12);
            border-radius: 14px;
            padding: .75rem .85rem;
            font-size: .95rem;
            outline: none;
            transition: all .15s ease;
            height: 46px;
        }
        .s-field:focus{
            border-color: rgba(34,199,199,.9);
            box-shadow: 0 0 0 .25rem rgba(34,199,199,.18);
        }
        .s-btn{
            height: 46px;
            border-radius: 14px;
            padding: 0 16px;
            border: none;
            font-weight: 700;
            transition: all .15s ease;
            white-space: nowrap;
        }
        .s-btn.search{
            background: #0b5564;
            color:#fff;
        }
        .s-btn.search:hover{
            filter: brightness(1.05);
            transform: translateY(-1px);
        }
        .s-btn.reset{
            background: transparent;
            color:#fff;
            text-decoration: underline;
            opacity: .95;
        }
        .s-btn.reset:hover{ opacity: 1; }

        /* Cards */
        .room-card{
            border-radius: var(--radius);
            overflow: hidden;
            transition: transform .15s ease, box-shadow .15s ease;
            background: var(--card);
        }
        .room-card:hover{
            transform: translateY(-2px);
            box-shadow: 0 .9rem 2rem rgba(2,6,23,.10);
        }
        .room-cover{
            height: 175px;
            position: relative;
            background: #f1f5f9;
        }
        .room-cover img{
            width: 100%;
            height: 100%;
            object-fit: cover;
            display:block;
        }
        .cover-shade{
            position:absolute; inset:0;
            background: linear-gradient(to bottom, rgba(0,0,0,.08), rgba(0,0,0,.45));
        }
        .badge-top{ position:absolute; top: 12px; left: 12px; }
        .room-title{
            position:absolute;
            bottom: 10px; left: 12px; right: 12px;
            color:#fff;
            text-shadow: 0 2px 10px rgba(0,0,0,.35);
        }
        .room-title .code{ font-size: 1.1rem; font-weight: 900; }
        .room-title .name{ font-size: .9rem; opacity: .92; }

        .meta{
            display:flex;
            gap:10px;
            flex-wrap: wrap;
            color: var(--muted);
            font-size: .9rem;
        }
        .meta b{ color: var(--ink); }

        .price{ font-weight: 900; font-size: 1.05rem; }
        .btn-soft{ border-radius: 12px; font-weight: 700; }

        /* Headline */
        .headline{
            font-size: 2rem;
            font-weight: 950;
            letter-spacing: -.6px;
        }
        .subline{ color: var(--muted); }

        /* Breadcrumb */
        .crumb{ color: var(--muted); font-size: .9rem; }
        .crumb a{ color: var(--muted); text-decoration:none; }
        .crumb a:hover{ text-decoration:underline; }

        /* ===== Sticky sidebars: FIX TH·ª§T XU·ªêNG ===== */
        .sticky-side{
            position: sticky;
            top: calc(var(--header-h, 0px) + var(--side-top-gap));
        }
        body.header-hidden .sticky-side{
            top: var(--side-top-gap);
        }

        /* ===== QU·∫¢NG C√ÅO: ·∫¢NH D√ÄI + CH·ªÆ N·∫∞M TR√äN ·∫¢NH ===== */
        .ad-banner{
            border-radius: 18px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(15,23,42,.10);
            box-shadow: 0 .9rem 2rem rgba(2,6,23,.08);
            background: #fff;
            min-height: 1280px;
        }

        .ad-banner img{
            position:absolute;
            inset:0;
            width:100%;
            height:100%;
            object-fit: cover;
            display:block;
            transform: scale(1.02);
        }

        .ad-overlay{
            position:absolute;
            inset:0;
            background:
                linear-gradient(to bottom, rgba(2,6,23,.65) 0%, rgba(2,6,23,.15) 45%, rgba(2,6,23,.70) 100%);
        }

        .ad-content{
            position:absolute;
            inset:0;
            display:flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 16px;
            color:#fff;
        }

        .ad-top{
            display:flex;
            justify-content: space-between;
            align-items:flex-start;
            gap:10px;
        }

        .ad-badge{
            background: rgba(255,255,255,.16);
            border: 1px solid rgba(255,255,255,.22);
            padding: 6px 10px;
            border-radius: 999px;
            font-size: .82rem;
            backdrop-filter: blur(6px);
            white-space: nowrap;
        }

        .ad-title{
            font-weight: 950;
            letter-spacing: .2px;
            font-size: 1.15rem;
            line-height: 1.2;
            text-shadow: 0 8px 20px rgba(0,0,0,.35);
        }

        .ad-sub{
            margin-top: 6px;
            font-size: .92rem;
            color: rgba(255,255,255,.92);
            text-shadow: 0 8px 18px rgba(0,0,0,.35);
        }

        .ad-bottom{
            background: rgba(15,23,42,.35);
            border: 1px solid rgba(255,255,255,.16);
            border-radius: 16px;
            padding: 12px;
            backdrop-filter: blur(8px);
        }
        .ad-bottom b{ color:#fff; }
        .ad-small{ font-size: .9rem; color: rgba(255,255,255,.92); }

        /* Chat widget */
        .chat-panel{
            position: fixed;
            right: 18px;
            bottom: 86px;
            width: min(360px, calc(100vw - 36px));
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 1rem 2rem rgba(0,0,0,.18);
            display:none;
            z-index: 1050;
            background: #fff;
        }
        .chat-header{
            background: #0f172a;
            color: #fff;
            padding: 10px 12px;
            display:flex;
            align-items:center;
            justify-content: space-between;
        }
        .chat-body{
            padding: 12px;
            height: 320px;
            overflow:auto;
            background: #f8f9fa;
        }
        .chat-msg{
            max-width: 85%;
            padding: 8px 10px;
            border-radius: 14px;
            margin-bottom: 8px;
            font-size: .92rem;
            line-height: 1.35;
        }
        .chat-bot{ background: #fff; border: 1px solid #e9ecef; }
        .chat-user{ background: #0d6efd; color:#fff; margin-left:auto; }
        .chat-foot{
            padding: 10px;
            border-top: 1px solid #e9ecef;
            display:flex;
            gap: 8px;
            background: #fff;
        }
        .chat-foot input{ border-radius: 999px; }

        /* ===== Floating Support (robot + zalo + hotline) ===== */
        .fab-stack{
            position: fixed;
            right: 18px;
            bottom: 18px;
            z-index: 1050;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
        }

        .fab-item{
            display:flex;
            align-items:center;
            gap:10px;
            transform: translateY(0);
            opacity: 1;
            pointer-events: auto;
            transition: all .18s ease;
        }

        .fab-label{
            background:#fff;
            border: 1px solid rgba(15,23,42,.10);
            color: #0f172a;
            border-radius: 999px;
            padding: 8px 12px;
            font-size: .9rem;
            box-shadow: 0 .75rem 1.5rem rgba(0,0,0,.12);
            white-space: nowrap;
        }

        .fab-btn{
            width: 56px;
            height: 56px;
            border-radius: 999px;
            border: none;
            display:flex;
            align-items:center;
            justify-content:center;
            box-shadow: 0 .75rem 1.5rem rgba(0,0,0,.18);
            font-size: 22px;
            cursor: pointer;
            text-decoration: none;
            transition: transform .15s ease, filter .15s ease;
        }
        .fab-btn:hover{ transform: translateY(-1px); filter: brightness(1.05); }

        .fab-robot{ background:#0f172a; color:#fff; }
        .fab-hotline{ background:#ef4444; color:#fff; }
        .fab-zalo{ background:#22c55e; color:#fff; }

        .fab-stack.is-collapsed .fab-secondary{
            opacity: 0;
            transform: translateY(10px);
            pointer-events: none;
        }
        .fab-stack.is-collapsed .fab-secondary .fab-label{
            opacity: 0;
            transform: translateX(8px);
        }

        @media (max-width: 576px){
            .fab-label{ display:none; }
        }

        /* =================== FOOTER ki·ªÉu nh∆∞ ·∫£nh b·∫°n g·ª≠i =================== */
        .pt-footer{
            margin-top: 28px;
            background: #ffffff;
            border-top: 1px solid rgba(15,23,42,.08);
        }
        .pt-footer .ft-wrap{
            padding: 28px 0 18px;
        }
        .ft-left-brand{
            display:flex;
            align-items:center;
            gap:12px;
            margin-bottom: 10px;
        }
        .ft-left-brand .ft-logo{
            width: 46px; height: 46px;
            border-radius: 16px;
            background: linear-gradient(135deg, var(--brand), var(--brand-dark));
            display:flex; align-items:center; justify-content:center;
            box-shadow: 0 .7rem 1.2rem rgba(34,199,199,.22);
            overflow:hidden;
            flex: 0 0 auto;
        }
        .ft-left-brand .ft-name{
            font-weight: 950;
            font-size: 1.25rem;
            letter-spacing: -.2px;
            color: var(--ink);
        }

        .ft-h{
            font-weight: 950;
            color: #0b3b8c;
            letter-spacing: .2px;
            margin-bottom: 14px;
            font-size: 1.05rem;
        }

        .ft-link{
            display:block;
            color: #0f172a;
            text-decoration: none;
            padding: 6px 0;
        }
        .ft-link:hover{ text-decoration: underline; }

        .ft-qr-area{
            margin-top: 10px;
            display:flex;
            gap:14px;
            align-items:flex-start;
        }
        .ft-qr{
            width: 120px;
            border-radius: 12px;
            border: 1px solid rgba(15,23,42,.10);
            padding: 8px;
            background:#fff;
        }
        .ft-store{
            display:flex;
            flex-direction: column;
            gap:10px;
        }
        .ft-store a{ display:inline-block; }
        .ft-store img{
            height: 44px;
            width: auto;
            border-radius: 10px;
            border: 1px solid rgba(15,23,42,.08);
        }

        .ft-contact{
            display:flex;
            flex-direction: column;
            gap: 12px;
        }
        .ft-ci{
            display:flex;
            gap: 12px;
            align-items:center;
            color: var(--ink);
        }
        .ft-ico{
            width: 38px; height: 38px;
            border-radius: 999px;
            background: rgba(2,132,199,.10);
            display:flex; align-items:center; justify-content:center;
            border: 1px solid rgba(2,132,199,.16);
            flex: 0 0 auto;
            font-size: 18px;
        }
        .ft-ci a{ color: var(--ink); text-decoration: none; }
        .ft-ci a:hover{ text-decoration: underline; }

        .ft-badges{
            margin-top: 10px;
            display:flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .ft-badge{
            display:inline-flex;
            align-items:center;
            gap:8px;
            padding: 8px 12px;
            border-radius: 999px;
            border: 1px solid rgba(15,23,42,.10);
            background: #fff;
            color: var(--ink);
            text-decoration: none;
            font-size: .92rem;
        }
        .ft-badge:hover{ box-shadow: 0 .75rem 1.5rem rgba(2,6,23,.08); }

        .ft-bottom{
            border-top: 1px solid rgba(15,23,42,.08);
            padding: 12px 0 18px;
            color: rgba(15,23,42,.70);
            font-size: .92rem;
        }
    </style>
</head>

<body class="bg-light">

<!-- HEADER -->
<header class="pt-header">
    <div class="container pt-container py-3 d-flex align-items-center justify-content-between gap-3 flex-wrap">
        <a class="brand" href="/">
            <div class="logo">
                <img th:src="@{/Svghome.png}" alt="Logo"
                     style="width:100%;height:100%;object-fit:cover;border-radius:12px;">
            </div>

            <div>
                <div class="name">Ph√≤ngt·ªët</div>
                <div class="sub">T√¨m ph√≤ng nhanh ‚Ä¢ G·ª≠i y√™u c·∫ßu g·ªçn</div>
            </div>
        </a>

        <div class="d-flex align-items-center gap-2 flex-wrap">
            <a class="nav-pill" href="/bills">üßæ Tra h√≥a ƒë∆°n</a>
            <a class="nav-pill" href="/feedback">üõ†Ô∏è Ph·∫£n √°nh</a>
            <a class="nav-pill primary" href="#search">üîé T√¨m ph√≤ng</a>
            <a class="nav-pill dark" href="/admin">Admin</a>
        </div>
    </div>

    <!-- SEARCH BAR -->
    <div class="search-wrap" id="search">
        <div class="container pt-container">
            <div class="search-bar">
                <form class="row g-2 align-items-center" onsubmit="return false;">
                    <div class="col-lg-4">
                        <input class="form-control s-field" id="q"
                               placeholder="T√¨m theo t√™n ph√≤ng, m√£ ph√≤ng, m√¥ t·∫£..."
                               autocomplete="off">
                    </div>

                    <div class="col-lg-2 col-md-4">
                        <select class="form-select s-field" id="price">
                            <option value="">Gi√° ph√≤ng</option>
                            <option value="0-2000000">D∆∞·ªõi 2,000,000</option>
                            <option value="2000000-3000000">2,000,000 - 3,000,000</option>
                            <option value="3000000-5000000">3,000,000 - 5,000,000</option>
                            <option value="5000000-999999999">Tr√™n 5,000,000</option>
                        </select>
                    </div>

                    <div class="col-lg-2 col-md-4">
                        <select class="form-select s-field" id="area">
                            <option value="">Di·ªán t√≠ch</option>
                            <option value="0-20">D∆∞·ªõi 20 m¬≤</option>
                            <option value="20-30">20 - 30 m¬≤</option>
                            <option value="30-50">30 - 50 m¬≤</option>
                            <option value="50-9999">Tr√™n 50 m¬≤</option>
                        </select>
                    </div>

                    <div class="col-lg-2 col-md-4">
                        <select class="form-select s-field" id="type">
                            <option value="">Lo·∫°i ph√≤ng</option>
                            <option value="mini">CƒÉn h·ªô mini</option>
                            <option value="phongtro">Ph√≤ng tr·ªç</option>
                            <option value="nguyencan">Nguy√™n cƒÉn</option>
                        </select>
                    </div>

                    <div class="col-lg-2 d-grid">
                        <button type="button" class="s-btn search" id="btnSearch">T√¨m ki·∫øm</button>
                    </div>

                    <div class="col-12 d-flex justify-content-end">
                        <button type="button" class="s-btn reset" id="btnReset">ƒê·∫∑t l·∫°i</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</header>
<div class="header-spacer"></div>

<!-- CONTENT -->
<div class="container pt-container py-4">

    <div th:if="${msg}" class="alert alert-success" th:text="${msg}"></div>
    <div th:if="${err}" class="alert alert-danger" th:text="${err}"></div>

    <div class="crumb mb-2">
        <a href="/">Trang ch·ªß</a> <span class="mx-1">‚Ä∫</span> <span>Ph√≤ng tr·ªëng</span>
    </div>

    <div class="d-flex align-items-end justify-content-between flex-wrap gap-2 mb-3">
        <div>
            <div class="headline">Cho thu√™ ph√≤ng tr·ªç</div>
            <div class="subline">Danh s√°ch ph√≤ng tr·ªëng ƒëang s·∫µn s√†ng cho thu√™.</div>
        </div>
        <div class="text-muted small">
            T·ªïng: <b id="countTotal" th:text="${#lists.size(rooms)}"></b> ph√≤ng
            ‚Ä¢ ƒêang hi·ªÉn th·ªã: <b id="countShown">0</b>
        </div>
    </div>

    <div class="row g-3 align-items-start">
        <!-- MAIN -->
        <div class="col-lg-9">
            <div class="row g-3" id="roomGrid">
                <div class="col-md-4 room-item" th:each="r : ${rooms}"
                     th:attr="data-code=${r.roomCode},
                              data-name=${r.roomName},
                              data-desc=${r.description},
                              data-price=${r.rentPrice},
                              data-area=${r.area}">
                    <div class="card border-0 shadow-sm room-card h-100">
                        <div class="room-cover">
                            <img th:if="${r.imageUrl != null}" th:src="${r.imageUrl}" alt="·∫¢nh ph√≤ng">
                            <img th:if="${r.imageUrl == null}"
                                 src="https://images.unsplash.com/photo-1505693314120-0d443867891c?auto=format&fit=crop&w=1200&q=60"
                                 alt="·∫¢nh ph√≤ng">
                            <div class="cover-shade"></div>
                            <span class="badge bg-success badge-top">EMPTY</span>
                            <div class="room-title">
                                <div class="code" th:text="${r.roomCode != null ? r.roomCode : ('#' + r.id)}"></div>
                                <div class="name" th:text="${r.roomName != null ? r.roomName : 'Ph√≤ng tr·ªç'}"></div>
                            </div>
                        </div>

                        <div class="card-body">
                            <div class="meta mb-2">
                                <div>üè¢ <b th:text="${'T·∫ßng ' + (r.floor != null ? r.floor : 1)}"></b></div>
                                <div>üë• <b th:text="${(r.maxPeople != null ? r.maxPeople : 1) + ' ng∆∞·ªùi'}"></b></div>
                                <div th:if="${r.area != null}">üìê <b th:text="${r.area + ' m¬≤'}"></b></div>
                            </div>

                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <div class="text-muted small">Gi√°</div>
                                    <div class="price">
                                        <span th:text="${#numbers.formatDecimal(r.rentPrice, 0, 'COMMA', 0, 'POINT')}"></span>
                                        <span class="text-muted" style="font-size:.9rem">ƒë</span>
                                    </div>
                                </div>
                                <a class="btn btn-primary btn-soft btn-sm" th:href="@{'/rooms/' + ${r.id}}">Xem ph√≤ng</a>
                            </div>

                            <div class="small text-muted mt-2" th:if="${r.description != null}">
                                <span th:text="${#strings.abbreviate(r.description, 90)}"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12" id="emptyState" style="display:none;">
                    <div class="alert alert-info mb-0">
                        Kh√¥ng t√¨m th·∫•y ph√≤ng ph√π h·ª£p. B·∫°n th·ª≠ ƒë·ªïi b·ªô l·ªçc nh√©.
                    </div>
                </div>

                <div class="col-12" th:if="${#lists.isEmpty(rooms)}">
                    <div class="alert alert-info mb-0">Hi·ªán ch∆∞a c√≥ ph√≤ng tr·ªëng.</div>
                </div>
            </div>
        </div>

        <!-- RIGHT SIDEBAR: QU·∫¢NG C√ÅO D√ÄI + CH·ªÆ TR√äN ·∫¢NH -->
        <aside class="col-lg-3 d-none d-lg-block">
            <div class="sticky-side">
                <div class="ad-banner">
                    <img th:src="@{/quangcao.jpg}" alt="Qu·∫£ng c√°o Ph√≤ng T·ªët">
                    <div class="ad-overlay"></div>

                    <div class="ad-content">
                        <div class="ad-top">
                            <div>
                                <div class="ad-title">Ph√≤ng T·ªët</div>
                                <div class="ad-sub">Cho thu√™ tr·ªç sinh vi√™n ‚Ä¢ gia ƒë√¨nh ‚Ä¢ gi√° r·∫ª</div>
                            </div>
                            <div class="ad-badge">Qu·∫£ng c√°o</div>
                        </div>

                        <div class="ad-bottom">
                            <div class="ad-small">
                                ‚úÖ G·∫ßn tr∆∞·ªùng, an ninh<br>
                                ‚úÖ Ph√≤ng s·∫°ch, v√†o ·ªü ngay<br>
                                üìû Hotline: <b>0343 841 111</b><br>
                                üí¨ Zalo: <b>0343 841 111</b><br>
                                ‚è∞ 08:00‚Äì22:00
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </aside>
    </div>
</div>

<!-- Chat widget -->
<div class="chat-panel" id="chatPanel" aria-hidden="true">
    <div class="chat-header">
        <div class="fw-semibold">ü§ñ Tr·ª£ l√Ω Ph√≤ngt·ªët</div>
        <button class="btn btn-sm btn-outline-light" type="button" id="chatClose">ƒê√≥ng</button>
    </div>
    <div class="chat-body" id="chatBody">
        <div class="chat-msg chat-bot">
            Ch√†o b·∫°n üëã M√¨nh gi√∫p l·ªçc ph√≤ng theo <b>gi√°</b>, <b>di·ªán t√≠ch</b>, <b>s·ªë ng∆∞·ªùi</b> ho·∫∑c t∆∞ v·∫•n th·ªß t·ª•c thu√™.
        </div>
        <div class="chat-msg chat-bot">
            G·ª£i √Ω: g√µ ‚Äúgi√° d∆∞·ªõi 3 tri·ªáu‚Äù ho·∫∑c ‚Äúph√≤ng 2 ng∆∞·ªùi‚Äù.
        </div>
    </div>
    <div class="chat-foot">
        <input class="form-control form-control-sm" id="chatInput" placeholder="Nh·∫≠p tin nh·∫Øn..." />
        <button class="btn btn-primary btn-sm" id="chatSend">G·ª≠i</button>
    </div>
</div>

<!-- Floating Support Buttons -->
<div class="fab-stack is-collapsed" id="fabStack">
    <div class="fab-item fab-secondary">
        <div class="fab-label">Zalo h·ªó tr·ª£</div>
        <a class="fab-btn fab-zalo"
           href="https://zalo.me/0343841111"
           target="_blank" rel="noopener"
           title="Zalo h·ªó tr·ª£">üí¨</a>
    </div>

    <div class="fab-item fab-secondary">
        <div class="fab-label">Hotline 0343841111</div>
        <a class="fab-btn fab-hotline"
           href="tel:0343841111"
           title="G·ªçi hotline">‚òé</a>
    </div>

    <div class="fab-item">
        <button class="fab-btn fab-robot" type="button" id="fabToggle" title="Robot h·ªó tr·ª£">ü§ñ</button>
    </div>
</div>

<!-- =================== FOOTER ki·ªÉu nh∆∞ ·∫£nh b·∫°n g·ª≠i =================== -->
<footer class="pt-footer">
    <div class="container pt-container ft-wrap">
        <div class="row g-4 align-items-start">
            <!-- LEFT -->
            <div class="col-lg-4">
                <div class="ft-left-brand">
                    <div class="ft-logo">
                        <img th:src="@{/Svghome.png}" alt="Logo" style="width:100%;height:100%;object-fit:cover;">
                    </div>
                    <div class="ft-name">PH√íNGT·ªêT</div>
                </div>

                <div class="text-muted" style="max-width: 340px;">
                    T·∫¢I APP PH√íNGT·ªêT NGAY
                </div>

                <div class="ft-qr-area">
                    <!-- QR: b·∫°n ƒë·ªïi file t·∫°i ƒë√¢y n·∫øu mu·ªën -->
                    <img class="ft-qr" th:src="@{/momo_qr_tight.png}" alt="QR Ph√≤ngt·ªët">

                    <div class="ft-store">
                        <a href="#" onclick="return false;">
                            <img alt="App Store"
                                 src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg">
                        </a>
                        <a href="#" onclick="return false;">
                            <img alt="Google Play"
                                 src="https://play.google.com/intl/en_us/badges/static/images/badges/vi_badge_web_generic.png">
                        </a>
                    </div>
                </div>

                <div class="mt-4 text-muted">Th√†nh vi√™n c·ªßa Ph√≤ngt·ªët</div>
                <div class="d-flex gap-2 flex-wrap mt-2">
                    <span class="badge text-bg-light border">Ph√≤ngt·ªët</span>
                    <span class="badge text-bg-light border">NVT</span>
                    <span class="badge text-bg-light border">Rent</span>
                </div>
            </div>

            <!-- MIDDLE -->
            <div class="col-lg-4">
                <div class="ft-h">H·ªÜ TH·ªêNG</div>
                <a class="ft-link" href="/admin">D√†nh cho ch·ªß tr·ªç</a>
                <a class="ft-link" href="#" onclick="return false;">Blog</a>
                <a class="ft-link" href="#" onclick="return false;">H∆∞·ªõng d·∫´n</a>
                <a class="ft-link" href="/feedback">Li√™n h·ªá</a>

                <div class="mt-4 ft-h">TH√îNG TIN</div>
                <a class="ft-link" href="#" onclick="return false;">ƒêi·ªÅu kho·∫£n &amp; Cam k·∫øt</a>
                <a class="ft-link" href="#" onclick="return false;">Quy ch·∫ø ho·∫°t ƒë·ªông</a>
                <a class="ft-link" href="#" onclick="return false;">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
            </div>

            <!-- RIGHT -->
            <div class="col-lg-4">
                <div class="ft-h">K·∫æT N·ªêI V·ªöI CH√öNG T√îI</div>

                <div class="ft-contact">
                    <div class="ft-ci">
                        <div class="ft-ico">üìû</div>
                        <div><a href="tel:0343841111"><b>0343 841 111</b></a></div>
                    </div>

                    <div class="ft-ci">
                        <div class="ft-ico">Z</div>
                        <div><a href="https://zalo.me/0343841111" target="_blank" rel="noopener"><b>0343841111</b></a></div>
                    </div>

                    <div class="ft-ci">
                        <div class="ft-ico">‚úâ</div>
                        <div><a href="mailto:thinhvannguyen113@gmail.com"><b>thinhvannguyen113@gmail.com</b></a></div>
                    </div>

                    <div class="ft-ci">
                        <div class="ft-ico">üìç</div>
                        <div><b>VP</b>: B·∫°n thay ƒë·ªãa ch·ªâ th·∫≠t ·ªü ƒë√¢y</div>
                    </div>
                </div>

                <div class="ft-badges">
                    <a class="ft-badge" href="#" onclick="return false;">üåê phongtot</a>
                    <a class="ft-badge" href="#" onclick="return false;">üìò phongtot</a>
                    <a class="ft-badge" href="#" onclick="return false;">üéµ phongtot</a>
                    <a class="ft-badge" href="#" onclick="return false;">‚ñ∂ phongtot</a>
                </div>
            </div>
        </div>
    </div>

    <div class="container pt-container ft-bottom">
        ¬© <span id="ftYear"></span> Ph√≤ngt·ªët ‚Ä¢ B·∫£n quy·ªÅn thu·ªôc v·ªÅ Ph√≤ngt·ªët
    </div>
</footer>

<script>
    // ====== Front-end filter ======
    function toNum(v){
        if (v == null) return NaN;
        const s = String(v).replaceAll(',', '').trim();
        const n = Number(s);
        return Number.isFinite(n) ? n : NaN;
    }

    function inRange(val, range){
        if (!range) return true;
        const [a,b] = range.split('-').map(Number);
        if (!Number.isFinite(a) || !Number.isFinite(b)) return true;
        return val >= a && val <= b;
    }

    function normalizeText(s){
        return (s || '').toString().toLowerCase().trim();
    }

    function applyFilter(){
        const q = normalizeText(document.getElementById('q').value);
        const priceRange = document.getElementById('price').value;
        const areaRange = document.getElementById('area').value;
        const type = document.getElementById('type').value;

        const items = Array.from(document.querySelectorAll('.room-item'));
        let shown = 0;

        items.forEach(el => {
            const code = normalizeText(el.dataset.code);
            const name = normalizeText(el.dataset.name);
            const desc = normalizeText(el.dataset.desc);
            const price = toNum(el.dataset.price);
            const area = toNum(el.dataset.area);

            const matchQ = !q || (code.includes(q) || name.includes(q) || desc.includes(q));
            const matchPrice = Number.isFinite(price) ? inRange(price, priceRange) : (priceRange ? false : true);
            const matchArea = Number.isFinite(area) ? inRange(area, areaRange) : (areaRange ? false : true);
            const matchType = !type || (desc.includes(type) || name.includes(type) || code.includes(type));

            const ok = matchQ && matchPrice && matchArea && matchType;

            el.style.display = ok ? '' : 'none';
            if (ok) shown++;
        });

        document.getElementById('countShown').innerText = String(shown);
        const es = document.getElementById('emptyState');
        if (es) es.style.display = shown === 0 ? '' : 'none';
    }

    document.getElementById('btnSearch').addEventListener('click', applyFilter);
    document.getElementById('q').addEventListener('input', applyFilter);

    document.getElementById('btnReset').addEventListener('click', () => {
        document.getElementById('q').value = '';
        document.getElementById('price').value = '';
        document.getElementById('area').value = '';
        document.getElementById('type').value = '';
        applyFilter();
        document.getElementById('q').focus();
    });

    applyFilter();

    // ====== Chat widget ======
    (function(){
        const panel = document.getElementById('chatPanel');
        const closeBtn = document.getElementById('chatClose');
        const body = document.getElementById('chatBody');
        const input = document.getElementById('chatInput');
        const send = document.getElementById('chatSend');

        const open = () => { panel.style.display='block'; panel.setAttribute('aria-hidden','false'); input.focus(); };
        const close = () => { panel.style.display='none'; panel.setAttribute('aria-hidden','true'); };

        closeBtn.addEventListener('click', close);

        const addMsg = (text, who) => {
            const div = document.createElement('div');
            div.className = 'chat-msg ' + (who === 'user' ? 'chat-user' : 'chat-bot');
            div.innerHTML = text;
            body.appendChild(div);
            body.scrollTop = body.scrollHeight;
        };

        const botReply = (q) => {
            const s = (q || '').toLowerCase();

            if (s.includes('d∆∞·ªõi 3') || s.includes('3 tri·ªáu')) {
                document.getElementById('price').value = '2000000-3000000';
                applyFilter();
                return 'M√¨nh ƒë√£ l·ªçc <b>2‚Äì3 tri·ªáu</b> cho b·∫°n ‚úÖ';
            }
            if (s.includes('d∆∞·ªõi 2') || s.includes('2 tri·ªáu')) {
                document.getElementById('price').value = '0-2000000';
                applyFilter();
                return 'Ok, m√¨nh l·ªçc <b>d∆∞·ªõi 2 tri·ªáu</b> ‚úÖ';
            }
            if (s.includes('di·ªán t√≠ch') && (s.includes('20') || s.includes('d∆∞·ªõi 20'))) {
                document.getElementById('area').value = '0-20';
                applyFilter();
                return 'M√¨nh ƒë√£ l·ªçc <b>d∆∞·ªõi 20m¬≤</b> ‚úÖ';
            }
            if (s.includes('th·ªß t·ª•c') || s.includes('gi·∫•y t·ªù')) {
                return 'Th∆∞·ªùng c·∫ßn CCCD + ƒë·∫∑t c·ªçc. B·∫°n b·∫•m ‚ÄúXem ph√≤ng‚Äù ‚Üí ‚ÄúG·ª≠i y√™u c·∫ßu‚Äù ƒë·ªÉ admin li√™n h·ªá.';
            }
            return 'B·∫°n mu·ªën m√¨nh l·ªçc theo <b>gi√°</b> hay <b>di·ªán t√≠ch</b>? V√≠ d·ª•: ‚Äúgi√° d∆∞·ªõi 3 tri·ªáu‚Äù.';
        };

        const onSend = () => {
            const text = input.value.trim();
            if (!text) return;
            addMsg(text, 'user');
            input.value = '';
            setTimeout(() => addMsg(botReply(text), 'bot'), 250);
        };

        send.addEventListener('click', onSend);
        input.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') onSend();
        });

        window.__openChat = open;
        window.__closeChat = close;
    })();

    // ===== Auto-hide HEADER when scroll down, show when scroll up =====
    (function(){
        const header = document.querySelector('.pt-header');
        const spacer = document.querySelector('.header-spacer');
        if (!header || !spacer) return;

        const setSpacerHeight = () => {
            const h = header.getBoundingClientRect().height;
            document.documentElement.style.setProperty('--header-h', h + 'px');
            spacer.style.height = 'var(--header-h)';
        };

        setSpacerHeight();
        window.addEventListener('resize', setSpacerHeight);

        let lastY = window.scrollY;
        let ticking = false;

        const onScroll = () => {
            const y = window.scrollY;

            if (y > lastY && y > 120) {
                header.classList.add('is-hidden');
                document.body.classList.add('header-hidden');
            }
            if (y < lastY) {
                header.classList.remove('is-hidden');
                document.body.classList.remove('header-hidden');
            }

            lastY = y;
            ticking = false;
        };

        window.addEventListener('scroll', () => {
            if (!ticking) {
                window.requestAnimationFrame(onScroll);
                ticking = true;
            }
        }, { passive: true });
    })();

    // ====== Toggle FAB ======
    (function(){
        const stack = document.getElementById('fabStack');
        const btn = document.getElementById('fabToggle');
        if (!stack || !btn) return;

        btn.addEventListener('click', () => {
            stack.classList.toggle('is-collapsed');
            if (!stack.classList.contains('is-collapsed')) {
                if (window.__openChat) window.__openChat();
            }
        });

        document.addEventListener('click', (e) => {
            if (!stack.contains(e.target)) stack.classList.add('is-collapsed');
        });
    })();

    // ===== footer year =====
    (function(){
        const y = document.getElementById('ftYear');
        if (y) y.innerText = new Date().getFullYear();
    })();
</script>

</body>
</html>
